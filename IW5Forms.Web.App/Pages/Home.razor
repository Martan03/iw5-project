@page "/"
@inject AuthenticationStateProvider AuthenticationStateProvider

<PageTitle>Home</PageTitle>

@if (HasAccess == null)
{
    <p>Loading...</p>
}
else if (HasAccess == true)
{
    <p>Welcome, you have the required permissions!</p>
}
else
{
    <p>You do not have the required permissions.</p>
}

<MudContainer MaxWidth="MaxWidth.Medium" Class="mt-4">
    <MudText Typo="Typo.h3" Class="mb-2 mt-2">
            Welcome to Master Forms!
    </MudText>
    <MudText Typo="Typo.h5" Class="mb-6">
            Here you can create, manage, and fill out all the forms in the world.
        </MudText>

    <MudPaper Class="p-4 mb-4 pa-3" Elevation="2">
        <MudText Typo="Typo.h4" GutterBottom="true" Class="mb-2">
            Authors
        </MudText>
        <MudList T="string">
            <MudListItem T="string">Jan Krahula (xkrahuj00)</MudListItem>
            <MudListItem T="string">Martin Slezák (xsleza26)</MudListItem>
            <MudListItem T="string">Adam Zatloukal (xzatloa00)</MudListItem>
        </MudList>
    </MudPaper>

        <MudText Typo="Typo.body1">
            This app was built using WebAssembly and MudBlazor.
        </MudText>
</MudContainer>

@code {
    private bool? HasAccess = null;

    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        var specificClaim = user.Claims.FirstOrDefault(c => c.Type == "role" && c.Value == "admin");
        HasAccess = specificClaim != null;
    }
}
